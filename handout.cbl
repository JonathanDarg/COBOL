000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. HANDOUT.
000300 AUTHOR. Jonathan.
000400 DATE-WRITTEN. 02/27/2025.
000500 ENVIRONMENT DIVISION.
000600 INPUT-OUTPUT SECTION.
000700 FILE-CONTROL.
000800*Index file containing the students and their grades
000900*Random access means we can look up any student by their
001000*name (in this case)
001100     SELECT GRADES-FILE ASSIGN TO FILENAME
001200     ORGANIZATION IS INDEXED
001300     ACCESS MODE IS RANDOM
001400     RECORD KEY IS STUDENT-RECORD-NAME.
001500 DATA DIVISION.
001600 FILE SECTION.
001700 FD GRADES-FILE.
001800 01 GRADES-RECORD.
001900     05 STUDENT-RECORD-NAME PIC X(8).
002000     05 STUDENT-GRADES OCCURS 8 TIMES PIC 9(4).
002100
002200 WORKING-STORAGE SECTION.
002300 01 STUDENT.
002400     05 STUDENT-NAME PIC X(8).
002500     05 STUDENT-GRADE-VALUES OCCURS 8 TIMES PIC 9(4).
002600
002700 01 INPUT-NAME PIC X(8).
002800 01 AVERAGE-GRADE PIC 999V99 VALUE 0.
002900 01 TOTAL-GRADE PIC 9(5)V99 VALUE 0.
003000 01 LETTER-GRADE PIC X.
003100 01 I PIC 99.
003200 01 J PIC 99.
003300*This table will store the 5 possible grade values
003400*Hint: We recommend using OCCURS Clause in the file record        
003500 01 POSSIBLE_GRADES PIC A OCCURS 5 TIMES.
003600*Table storing the frequency of each letter grade
003700 01 GRADE_FREQUENCIES PIC 9 OCCURS 5 TIMES.
003800*The name of the file (which will be retrieved from the user)     
003900 01 FILENAME PIC X(64).
004000
004100 PROCEDURE DIVISION.
004200*MAIN Paragraph, execution starts here
004300 MAIN.
004400     PERFORM SET-GRADES.
004500     DISPLAY "Enter the filename: " WITH NO ADVANCING.
004600     ACCEPT FILENAME.
004700     PERFORM GET-ENTRIES.
004800     PERFORM DISPLAY-FREQUENCIES.
004900     STOP RUN.
005000
005100*Repeatedly ask the user to enter the names of students
005200*and process each valid student
005300 GET-ENTRIES.
005400     OPEN INPUT GRADES-FILE.
005500     PERFORM WITH TEST AFTER UNTIL INPUT-NAME = "0"
005600         DISPLAY "Enter student name (or 0 to quit): "
005700             WITH NO ADVANCING
005800         ACCEPT INPUT-NAME
005900         IF INPUT-NAME NOT = "0"
006000             MOVE INPUT-NAME TO STUDENT-RECORD-NAME
006100             PERFORM LOOKUP-STUDENT
006200         END-IF
006300     END-PERFORM.
006400     CLOSE GRADES-FILE.
006500
006600*Process the record only if it is in the file
006700 LOOKUP-STUDENT.
006800     READ GRADES-FILE INTO STUDENT
006900         KEY IS STUDENT-RECORD-NAME
007000             INVALID KEY
007100                 DISPLAY "Student not found: " INPUT-NAME
007200             NOT INVALID KEY
007300                 PERFORM PROCESS-RECORD
007400     END-READ.
007500
007600*Calculates the average grade for the current student and
007700*Updates the letter grade frequency
007800 PROCESS-RECORD.
007900     PERFORM AVERAGE.
008000     DISPLAY "Average: " AVERAGE-GRADE "%".
008100     IF AVERAGE-GRADE >= 90
008200         MOVE "A" TO LETTER-GRADE
008300         ADD 1 TO GRADE_FREQUENCIES(5)
008400     ELSE IF AVERAGE-GRADE >= 80
008500         MOVE "B" TO LETTER-GRADE
008600         ADD 1 TO GRADE_FREQUENCIES(4)
008700     ELSE IF AVERAGE-GRADE >= 70
008800         MOVE "C" TO LETTER-GRADE
008900         ADD 1 TO GRADE_FREQUENCIES(3)
009000     ELSE IF AVERAGE-GRADE >= 60
009100         MOVE "D" TO LETTER-GRADE
009200         ADD 1 TO GRADE_FREQUENCIES(2)
009300     ELSE
009400         MOVE "F" TO LETTER-GRADE
009500         ADD 1 TO GRADE_FREQUENCIES(1)
009600     END-IF.
009800
009900*Calculates the average grade for the current student
009100 AVERAGE.
009200     MOVE 0 TO TOTAL-GRADE.
009300     PERFORM VARYING I FROM 1 BY 1 UNTIL I > 8
009400         COMPUTE TOTAL-GRADE = TOTAL-GRADE +
009500             (STUDENT-GRADE-VALUES(I) / 100)
009600     END-PERFORM.
009700     COMPUTE AVERAGE-GRADE = TOTAL-GRADE / 8.
009800
011100*Displays every letter grade and its corresponding frequency      
011200 DISPLAY-FREQUENCIES.
011300 DISPLAY "Grade Frequencies:".
011400 DISPLAY "A: " GRADE_FREQUENCIES(5).
011500 DISPLAY "B: " GRADE_FREQUENCIES(4).
011600 DISPLAY "C: " GRADE_FREQUENCIES(3).
011700 DISPLAY "D: " GRADE_FREQUENCIES(2).
011800 DISPLAY "F: " GRADE_FREQUENCIES(1).
011900
011800*Initializes the array containing all possible letter grades      
011900 SET-GRADES.
008200     MOVE "F" TO POSSIBLE_GRADES(1).
008300     MOVE "D" TO POSSIBLE_GRADES(2).
008400     MOVE "C" TO POSSIBLE_GRADES(3).
008500     MOVE "B" TO POSSIBLE_GRADES(4).
008600     MOVE "A" TO POSSIBLE_GRADES(5).

